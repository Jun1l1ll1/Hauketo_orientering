<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Hauketo orientering</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <button class="leave_btn" onclick="exit('admincode')">Logg ut</button>

    <div class="header">
        <button class="back_btn" onclick="back('admin')">< Til oversikt</button>
    </div>
    
    <div class="center_vertical">
        <div class="admin_cont">

            <div id="numset_cont" class="container hide"> <!-- Shown in show_numsets() func -->
                <h4>Nummersett</h4>
                <ul id="all_numsets_ul" class="numset_ul">
                    <!-- Info added in show_numsets() func -->
                </ul>

                <div id="numset_edit_div" class="numset_edit_div hide">
                    <!--? Allow delete -->
                    <input id="numset_edit_name" placeholder="Set-navn" type="text" disabled> <!--? Allow to change name -->
                    <input id="numset_edit_from" class="numset_limit_inp" placeholder="Fra" min="1" type="number">
                    <input id="numset_edit_to" class="numset_limit_inp" placeholder="Til" min="1" type="number">
                    <button onclick="module.editGroupNumSet()" class="small c_check">✔</button>
                    <button onclick="close_edit_numset()" class="small ct_obscure">✖</button>
                </div>
            </div>

            <button id="new_post_or_group_btn" class="f_bold c_check">Legg til ny</button>

            <div id="add_post_cont" class="container add_post_cont hide">
                <!-- Added when user clicks new_post_or_group_btn using open_edit_group_members() -->
            </div>

            <!-- <div> <!--? Is this something?? I don't remember
                <p>Status kommer her...</p>
                <br/>
            </div> -->

            <div class="container">
                <h4 id="edit_existing_title"></h4>
                <ul class="edit_list" id="edit_list">
                    <li class="edit_existing_li">Vent litt...</li>
                    <!-- <li class="edit_existing_li"> <button onclick="open_edit_group_members('0')" class="small">Gruppe 0 <span>- Navn N. N., Navne N.</span></button> <button class="remove_btn small">Fjern</button></li>
                    <li class="edit_existing_li"> <button onclick="open_edit_group_members('1')" class="small">Gruppe 1 <span>- Navn N. N., Navne N.</span></button> <button class="remove_btn small">Fjern</button></li>
                    <li class="edit_existing_li"> Post 0 <span>- Kode: 1NGN</span> <button class="remove_btn small">Fjern</button></li> -->
                </ul>
            </div>

        </div>
    </div>
    
</body>
<script src="script.js"></script>

<script> 
    const module = {};
</script>

<script type="module">
    import { verifyACode, editMembers, removeDoc, newPost, getAllGroups, getAllPosts, getAllGroupNumSets, editGroupNumSet, openEditGroup } from "./db.js";
    module.editMembers = editMembers;
    module.removeDoc = removeDoc;
    module.newPost = newPost;
    module.editGroupNumSet = editGroupNumSet;
    module.openEditGroup = openEditGroup;

    const acode = get_cookie("admincode");

    const correct = await verifyACode(acode);
    if (!correct) {
        exit("admincode");
    }

    if (get_edit_type() == 'groups') {
        document.getElementById('new_post_or_group_btn').setAttribute('onclick','module.openEditGroup()');
        document.getElementById('edit_existing_title').innerText = 'Rediger eksisterende grupper';
        let all_groups = await getAllGroups();
        show_all_groups(all_groups);

        let all_numsets = await getAllGroupNumSets();
        show_numsets(all_numsets);

    } else {
        document.getElementById('new_post_or_group_btn').setAttribute('onclick','module.newPost()');
        document.getElementById('edit_existing_title').innerText = 'Oversikt over eksisterende poster';
        let all_posts = await getAllPosts();
        show_all_posts(all_posts);
    }


    //TODO Get current members of each group, and fill the list
    //TODO Do the same for posts if ?edit=posts (but no members)
</script>
</html>